<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=0.9, shrink-to-fit=no"
    />
    <meta name="description" content="Front-end des Alex d'or" />

    <link rel="stylesheet" href="www/css/style.css" />
    <link
      href="https://fonts.googleapis.com/css?family=Staatliches"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans%7CStaatliches"
      rel="stylesheet"
    />
    <!-- CSS BOOTSTRAP -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />
    <!-- FONTAWESOME -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
      integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/"
      crossorigin="anonymous"
    />
    <title>Alex d'Or</title>
  </head>
  <body>
    <!-- HEADER -->
    <header>
      <nav class="navbar navbar-expand-lg">
        <a class="navbar-brand" href="#">
          <img
            src="www/assets/header_logo.png"
            width="200"
            class="imageflottante"
        /></a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"
            ><i class="fas fa-bars fa-2x"></i
          ></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item active">
              <a class="nav-link" href="#"
                >Accueil <span class="sr-only">(actuel)</span></a
              >
            </li>
            <li class="nav-item active">
              <a class="nav-link" href="#"
                >News <span class="sr-only">(actuel)</span></a
              >
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="www/html/concours.htm"
                id="navbarDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                Session 2019
              </a>
              <div
                class="dropdown-menu colorlink"
                aria-labelledby="navbarDropdown"
              >
                <a class="dropdown-item" href="#">Règlement</a>
                <a class="dropdown-item" href="#">Jeux en lice</a>
                <a class="dropdown-item" href="#">Inscrire un jeu</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#">Devenir juré</a>
              </div>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="www/html/jeux.html"
                id="navbarDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                Archives
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="#">Anciennes sessions</a>
                <a class="dropdown-item" href="#">Jeux vainqueurs</a>
                <a class="dropdown-item" href="#">Tous les jeux</a>
                <a class="dropdown-item" href="#">Séries de jeu</a>
                <a class="dropdown-item" href="#">Un jeu au hasard</a>
              </div>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="www/html/forum.html"
                id="navbarDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                Forum
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="#">Index du forum</a>
                <a class="dropdown-item" href="#">Nouveaux messages</a>
              </div>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="www/html/communaute.html"
                id="navbarDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                Communauté
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="#">Derniers commentaires</a>
                <a class="dropdown-item" href="#">Liste des membres</a>
              </div>
            </li>
            <li>
              <select id="changeStyle">
                <option>Thème sombre</option>
                <option>Thème clair</option>
              </select>
            </li>
          </ul>
        </div>
      </nav>
    </header>

    <!-- CONTENU PRINCIPAL -->
    <main>
      <div class="container">
        <div class="row text-center py-3">
          <div class="col-12">
            <h1>Bienvenue dans le site des Alex d'Or !</h1>
            <p>
              Bienvenue au concours des Alex d'or !<br> Qui depuis 2001 décerne des récompenses
              <br> à des jeux vidéos amateurs.<br> 
              Que la compétition commence !
              <a href="html/concours.html">Plus d'infos</a>
            </p>
          </div>
          <div id="demo" class="carousel slide" data-ride="carousel">

          <!-- Indicators -->
          <ul class="carousel-indicators">
            <li data-target="#demo" data-slide-to="0" class="active"></li>
            <li data-target="#demo" data-slide-to="1"></li>
            <li data-target="#demo" data-slide-to="2"></li>
          </ul>

          <!-- Le carrousel -->
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img src="https://www.alexdor.info/design/newdefaut/interface/jure.jpg" alt="Los jury">
            </div>
            <div class="carousel-item">
              <img src="https://www.alexdor.info/uploads/carrousel/id-aw-2017-2018.png" alt="awards">
            </div>
            <div class="carousel-item">
              <img src="https://www.alexdor.info/design/newdefaut/interface/id-carrousel2017-2018.png" alt="vainqueurs">
            </div>
          <!-- Contrôles à droite à gauche -->
          <a class="carousel-control-prev" href="#demo" data-slide="prev">
            <span class="carousel-control-prev-icon"></span>
          </a>
          <a class="carousel-control-next" href="#demo" data-slide="next">
            <span class="carousel-control-next-icon"></span>
          </a>
      </div>
          <hr />
          <div class="row text-center py-3">
          <div class="col-12"><h2>Dernières news des Alex d'Or</h2></div>
        </div>
        <div class="col-12">
          <div
            class="piece-of-news"
            style="border: 1px solid #555; margin-bottom: 20px; padding: 10px"
            v-for="pon in news"  
            :key="pon.id"
          > 
            <h3>{{ pon.title }}</h3> <b><a href="">Lire l'article en entier</a></b>
            <p style="font-style: italic">Posté le {{ pon.created_at }}</p>
            <p style="font-weight: bold">{{ pon.user.username }}</p>
            <div
              class="news-content"
              style="width: 100%;"
              v-html="pon.content">
          </div></div>
        </div>
      </div>
    </div>
    </main>

    <!-- FOOTER-->
    <footer></footer>

    <!-- SCRIPT BOOTSTRAP -->
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
      integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
      integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <!-- SCRIPT CHANGEMENT DE STYLE -->
    <script>
        document.getElementById("changeStyle")
        .addEventListener("change", function() {
          var theme = document.getElementById("changeStyle").value;
          bod = document.getElementsByTagName("main")[0];
          if (theme == "Thème clair") {
            bod.style.backgroundColor = "#f8ebd3";
            bod.style.color = "#1f2529";
          } else {
            bod.style.backgroundColor = "#1f2529";
            bod.style.color = "#f8ebd3";
          }
        });

      function nl2br(str, isXhtml) {
        if (typeof str === "undefined" || str === null) {
          return "";
        }
        var breakTag =
          isXhtml || typeof isXhtml === "undefined" ? "<br />" : "<br>";
        return (str + "").replace(
          /([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,
          "$1" + breakTag + "$2"
        );
      }
      new Vue({
        el: ".container",
        data: {
          news: []
        },
        mounted: async function() {
          const newsWithoutNewLines = await axios.get(
            "https://www.alexdor.info/api/v0/news"
          );
          this.news = newsWithoutNewLines.data.map(pon => {
            pon.content = nl2br(pon.content);
            return pon;
          });
        }
      });
    </script>
  </body>
